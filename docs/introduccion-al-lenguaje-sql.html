<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 2 Introducción al lenguaje SQL | Prácticas de Tecnologías de Gestión de Datos</title>
  <meta name="description" content="Prácticas de la asignatura de Tecnologías de Gestión de Datos del Máster en Técnicas Estadísticas." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 2 Introducción al lenguaje SQL | Prácticas de Tecnologías de Gestión de Datos" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Prácticas de la asignatura de Tecnologías de Gestión de Datos del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 2 Introducción al lenguaje SQL | Prácticas de Tecnologías de Gestión de Datos" />
  
  <meta name="twitter:description" content="Prácticas de la asignatura de Tecnologías de Gestión de Datos del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén F. Casal (ruben.fcasal@udc.es), Guillermo López Taboada (guillermo.lopez.taboada@udc.es)" />


<meta name="date" content="2019-09-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduccion-a-las-tecnologias-de-gestion-de-datos.html"/>
<link rel="next" href="introduccion-a-tecnologias-nosql.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Prácticas de TGD</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="introduccion-a-las-tecnologias-de-gestion-de-datos.html"><a href="introduccion-a-las-tecnologias-de-gestion-de-datos.html"><i class="fa fa-check"></i><b>1</b> Introducción a las Tecnologías de Gestión de Datos</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion-a-las-tecnologias-de-gestion-de-datos.html"><a href="introduccion-a-las-tecnologias-de-gestion-de-datos.html#introduccion"><i class="fa fa-check"></i><b>1.1</b> Introducción</a></li>
<li class="chapter" data-level="1.2" data-path="introduccion-a-las-tecnologias-de-gestion-de-datos.html"><a href="introduccion-a-las-tecnologias-de-gestion-de-datos.html#contenidos"><i class="fa fa-check"></i><b>1.2</b> Contenidos</a></li>
<li class="chapter" data-level="1.3" data-path="introduccion-a-las-tecnologias-de-gestion-de-datos.html"><a href="introduccion-a-las-tecnologias-de-gestion-de-datos.html#planificacion"><i class="fa fa-check"></i><b>1.3</b> Planificación</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduccion-a-las-tecnologias-de-gestion-de-datos.html"><a href="introduccion-a-las-tecnologias-de-gestion-de-datos.html#evaluacion"><i class="fa fa-check"></i><b>1.3.1</b> Evaluación</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduccion-a-las-tecnologias-de-gestion-de-datos.html"><a href="introduccion-a-las-tecnologias-de-gestion-de-datos.html#fuentes-de-informacion"><i class="fa fa-check"></i><b>1.4</b> Fuentes de información:</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduccion-a-las-tecnologias-de-gestion-de-datos.html"><a href="introduccion-a-las-tecnologias-de-gestion-de-datos.html#basica"><i class="fa fa-check"></i><b>1.4.1</b> Básica</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduccion-a-las-tecnologias-de-gestion-de-datos.html"><a href="introduccion-a-las-tecnologias-de-gestion-de-datos.html#complementaria"><i class="fa fa-check"></i><b>1.4.2</b> Complementaria:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html"><i class="fa fa-check"></i><b>2</b> Introducción al lenguaje SQL</a><ul>
<li class="chapter" data-level="2.1" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#bases-de-datos-relacionales"><i class="fa fa-check"></i><b>2.1</b> Bases de Datos Relacionales</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#definiciones"><i class="fa fa-check"></i><b>2.1.1</b> Definiciones</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#sintaxis-sql"><i class="fa fa-check"></i><b>2.2</b> Sintaxis SQL</a><ul>
<li class="chapter" data-level="2.2.1" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#extraccion-sql-11-statements"><i class="fa fa-check"></i><b>2.2.1</b> Extracción SQL (11 statements)</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#crearactualizarborrar-tablas-sql-8-statements"><i class="fa fa-check"></i><b>2.2.2</b> Crear/Actualizar/Borrar tablas SQL (8 statements)</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#anadiractualizarborrar-tuplas-en-sql-3-statements"><i class="fa fa-check"></i><b>2.2.3</b> Añadir/Actualizar/Borrar tuplas en SQL (3 statements)</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#gestion-bases-de-datos-5-statements"><i class="fa fa-check"></i><b>2.2.4</b> Gestión Bases de Datos (5 statements)</a></li>
<li class="chapter" data-level="2.2.5" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#ejemplos-de-consultas-sql"><i class="fa fa-check"></i><b>2.2.5</b> Ejemplos de consultas SQL</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#conexion-con-bases-de-datos-desde-r"><i class="fa fa-check"></i><b>2.3</b> Conexión con bases de datos desde R</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#introduccion-a-sql-en-r"><i class="fa fa-check"></i><b>2.3.1</b> Introducción a SQL en R</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#el-paquete-sqldf"><i class="fa fa-check"></i><b>2.3.2</b> El paquete sqldf</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html#sql-queries"><i class="fa fa-check"></i><b>2.3.3</b> SQL Queries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html"><i class="fa fa-check"></i><b>3</b> Introducción a Tecnologías NoSQL</a><ul>
<li class="chapter" data-level="3.1" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html#conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos"><i class="fa fa-check"></i><b>3.1</b> Conceptos y tipos de bases de datos NoSQL (documental, columnar, clave/valor y de grafos)</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html#caracteristicas-de-las-bases-de-datos-nosql"><i class="fa fa-check"></i><b>3.1.1</b> Características de las bases de datos NoSQL</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html#tipos-de-bases-de-datos-nosql"><i class="fa fa-check"></i><b>3.1.2</b> Tipos de Bases de Datos NoSQL</a></li>
<li class="chapter" data-level="3.1.3" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html#mongodb-nosql-documental"><i class="fa fa-check"></i><b>3.1.3</b> MongoDB: NoSQL documental</a></li>
<li class="chapter" data-level="3.1.4" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html#redis-nosql-key-value"><i class="fa fa-check"></i><b>3.1.4</b> Redis: NoSQL key-value</a></li>
<li class="chapter" data-level="3.1.5" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html#cassandra-nosql-columnar"><i class="fa fa-check"></i><b>3.1.5</b> Cassandra: NoSQL columnar</a></li>
<li class="chapter" data-level="3.1.6" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html#neo4j-nosql-grafos"><i class="fa fa-check"></i><b>3.1.6</b> Neo4j: NoSQL grafos</a></li>
<li class="chapter" data-level="3.1.7" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html#otros-search-engines"><i class="fa fa-check"></i><b>3.1.7</b> Otros: search engines</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html#conexion-de-r-a-nosql"><i class="fa fa-check"></i><b>3.2</b> Conexión de R a NoSQL</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tecnologias-para-el-tratamiendo-de-datos-masivos.html"><a href="tecnologias-para-el-tratamiendo-de-datos-masivos.html"><i class="fa fa-check"></i><b>4</b> Tecnologías para el Tratamiendo de Datos Masivos</a><ul>
<li class="chapter" data-level="4.1" data-path="tecnologias-para-el-tratamiendo-de-datos-masivos.html"><a href="tecnologias-para-el-tratamiendo-de-datos-masivos.html#tecnologias-big-data-hadoop-spark-hive-rspark-sparklyr"><i class="fa fa-check"></i><b>4.1</b> Tecnologías Big Data (Hadoop, Spark, Hive, Rspark, Sparklyr)</a></li>
<li class="chapter" data-level="4.2" data-path="tecnologias-para-el-tratamiendo-de-datos-masivos.html"><a href="tecnologias-para-el-tratamiendo-de-datos-masivos.html#visualizacion-y-generacion-de-cuadros-de-mando"><i class="fa fa-check"></i><b>4.2</b> Visualización y Generación de Cuadros de Mando</a></li>
<li class="chapter" data-level="4.3" data-path="tecnologias-para-el-tratamiendo-de-datos-masivos.html"><a href="tecnologias-para-el-tratamiendo-de-datos-masivos.html#introduccion-al-analisis-de-datos-masivos"><i class="fa fa-check"></i><b>4.3</b> Introducción al Análisis de Datos Masivos</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Prácticas de Tecnologías de Gestión de Datos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduccion-al-lenguaje-sql" class="section level1">
<h1><span class="header-section-number">Capítulo 2</span> Introducción al lenguaje SQL</h1>
<p>Los sistemas de información gestionan repositorios de información en múltiples formatos,
siendo el más popular las bases de datos relacionales a las que se accede mediante SQL (Structured Query Language)</p>
<div id="bases-de-datos-relacionales" class="section level2">
<h2><span class="header-section-number">2.1</span> Bases de Datos Relacionales</h2>
<div id="definiciones" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Definiciones</h3>
<ul>
<li><p><strong>Dominio</strong>: contexto (organización, empresa, evento…) objeto de gestión de la información.</p></li>
<li><p><strong>Dato</strong>: hecho con significado implícito, registable, relevante en un determinado dominio.</p></li>
<li><p><strong>Base de datos</strong>: colección de datos de un determinado dominio relacionados entre sí, organizados de forma que sea posible manipularlos y recuperarlos de forma eficiente.</p></li>
<li>Sistema de Gestión de Bases de Datos (<strong>SGBD</strong>) (en inglés <strong>RDBMS</strong>, Relational Database Management System): software que permite a los usuarios crear y manipular bases de datos mediante operaciones CRUD:
<ul>
<li>Crear / Insertar Datos (Create)</li>
<li>Consultar / Leer (Read)</li>
<li>Actualizar / Modificar (Update)</li>
<li>Eliminar (Delete)</li>
</ul></li>
</ul>
<hr />
<ul>
<li><strong>Modelo de datos</strong>: abstracción conceptual que propone una manera de organizar y manipular los datos. Definido mediante:
<ul>
<li>Estructura: elementos para organizar datos</li>
<li>Integridad: reglas para relaciones los elementos</li>
<li>Manipulación: operaciones sobre los datos adaptadas a la estructura y reglas</li>
</ul></li>
<li><p>Modelo de datos conceptual <strong>Entidad Relación</strong> (entidades, relaciones, atributos)</p></li>
<li>Modelo de datos lógico o de representación (<strong>modelo relacional</strong> de Codd)
<ul>
<li>Datos en relaciones (tablas)</li>
<li>Base matemática formal</li>
<li>Flexible</li>
</ul></li>
<li><p>Modelo de datos físico (tal y como se almacenan los datos)</p></li>
</ul>
<p>Una fila de la tabla (relación) es una tupla y una columna un atributo.</p>
<p><img src="images/Relacion.png" width="600" /></p>
<p>Una base de datos es un conjunto de tablas (al menos una).</p>
<p><img src="images/BBDD.png" width="600" /></p>
<p>La tabla no es una relación porque la relación es un conjunto sin orden y una tabla puede tener filas repetidas y tiene orden.</p>
<hr />
<ul>
<li><p><strong>Esquema</strong>: estructura de la base de datos</p></li>
<li><p><strong>Estado</strong>: contenido de la base de datos</p></li>
<li><p>Restricción de <strong>integridad</strong>: regla que debe cumplir la información registrada en la base de datos para garantizar la integridad de la información.</p></li>
</ul>
<p>Cualquier Base de Datos basada en el modelo relacional ha de cumplir como mínimo estas restricciones (además de las propias del dominio):</p>
<ul>
<li><p>Restricción de dominio: el valor de cada atributo debe de ser único (teléfono, no valor único), no descomponible (nombre completo descomponible en nombre y apellidos, domicilio en calle, CP, localidad, etc…)</p></li>
<li><p>Una relación es un conjunto de tuplas, por tanto todas las tuplas son distintas.</p></li>
<li><p>Una <strong>superclave</strong> es un subconjunto de atributos tal que no existen dos tuplas con la misma superclave.</p></li>
</ul>
<blockquote>
<p>Ejercicio. En la relación Empleado(dni, nombre, apellidos, email) ¿cuántas superclaves existen?</p>
</blockquote>
<ul>
<li>Una <strong>clave candidata</strong> es una superclave mínima (superclave mínima es la clave a la que no se le puede eliminar un atributo).</li>
</ul>
<blockquote>
<p>¿Cuántas claves candidatas hay en el ejemplo anterior?</p>
</blockquote>
<ul>
<li><p><strong>Clave primaria</strong> es la clave candidata que elegimos que identificar de forma unívoca las tuplas de una relación. Restricción de integridad de entidad: Ningún valor de la clave primaria puede ser un valor nulo.</p></li>
<li><p><strong>Clave foránea</strong> es un conjunto de atributos de una relación R_1 que, para cada tupla, identifican a otra tupla de una relación R_2 con la que está relacionada.
La Restricción de integridad referencial nos dice que la clave foránea ha de corresponderse con la clave primaria de R_2, y si la clave foránea no es nula ha de refir a una tupla en R_2.</p></li>
</ul>
<p><img src="images/ClaveForanea.png" width="600" /></p>
<p><img src="images/IntegridadReferencial.png" width="600" /></p>
<p>Si borramos/actualizamos un valor de clave foránea podemos: (a) prohibir el cambio, o (b) poner a nulo la clave foránea (borrado) o propogar el cambio (modificación).</p>
<hr />
<ul>
<li>Ventajas de SGBD:
<ul>
<li>Administración centralizada de los datos (por un administrador en un servidor/plataforma central que evita la información en silos -redundante/inconsistente)</li>
<li>Desacoplado del almacenamiento físico de los datos (no es necesario conocerlo)</li>
<li>Simplicidad de acceso (ODBC + SQL, lenguaje declarativo)</li>
<li>Control de integridad (restricciones genéricas, integridad de entidad y referencial, de dominio, y las del dominio en software)</li>
<li>Control de acceso concurrente (evita inconsistencia)</li>
<li>Seguridad (autenticación, roles de acceso)</li>
<li>Recuperación ante fallos (backup, logs y transacciones -rollback-)</li>
</ul></li>
</ul>
</div>
</div>
<div id="sintaxis-sql" class="section level2">
<h2><span class="header-section-number">2.2</span> Sintaxis SQL</h2>
<p>A continuación 27 clásulas SQL básicas</p>
<div id="extraccion-sql-11-statements" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Extracción SQL (11 statements)</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">SELECT column1, column2....columnN</a>
<a class="sourceLine" id="cb2-2" title="2">FROM   table_name;</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">SELECT DISTINCT column1, column2....columnN</a>
<a class="sourceLine" id="cb2-5" title="5">FROM   table_name;</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7">SELECT column1, column2....columnN</a>
<a class="sourceLine" id="cb2-8" title="8">FROM   table_name</a>
<a class="sourceLine" id="cb2-9" title="9">WHERE  CONDITION;</a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11">SELECT column1, column2....columnN</a>
<a class="sourceLine" id="cb2-12" title="12">FROM   table_name</a>
<a class="sourceLine" id="cb2-13" title="13">WHERE  CONDITION<span class="dv">-1</span> {AND<span class="op">|</span>OR} CONDITION<span class="dv">-2</span>;</a>
<a class="sourceLine" id="cb2-14" title="14"></a>
<a class="sourceLine" id="cb2-15" title="15">SELECT column1, column2....columnN</a>
<a class="sourceLine" id="cb2-16" title="16">FROM   table_name</a>
<a class="sourceLine" id="cb2-17" title="17">WHERE  column_name <span class="kw">IN</span> (val<span class="dv">-1</span>, val<span class="dv">-2</span>,...val<span class="op">-</span>N);</a>
<a class="sourceLine" id="cb2-18" title="18"></a>
<a class="sourceLine" id="cb2-19" title="19">SELECT column1, column2....columnN</a>
<a class="sourceLine" id="cb2-20" title="20">FROM   table_name</a>
<a class="sourceLine" id="cb2-21" title="21">WHERE  column_name BETWEEN val<span class="dv">-1</span> AND val<span class="dv">-2</span>;</a>
<a class="sourceLine" id="cb2-22" title="22"></a>
<a class="sourceLine" id="cb2-23" title="23">SELECT column1, column2....columnN</a>
<a class="sourceLine" id="cb2-24" title="24">FROM   table_name</a>
<a class="sourceLine" id="cb2-25" title="25">WHERE  column_name LIKE { PATTERN };</a>
<a class="sourceLine" id="cb2-26" title="26"></a>
<a class="sourceLine" id="cb2-27" title="27">SELECT column1, column2....columnN</a>
<a class="sourceLine" id="cb2-28" title="28">FROM   table_name</a>
<a class="sourceLine" id="cb2-29" title="29">WHERE  CONDITION</a>
<a class="sourceLine" id="cb2-30" title="30">ORDER BY column_name {ASC<span class="op">|</span>DESC};</a>
<a class="sourceLine" id="cb2-31" title="31"></a>
<a class="sourceLine" id="cb2-32" title="32">SELECT <span class="kw">SUM</span>(column_name)</a>
<a class="sourceLine" id="cb2-33" title="33">FROM   table_name</a>
<a class="sourceLine" id="cb2-34" title="34">WHERE  CONDITION</a>
<a class="sourceLine" id="cb2-35" title="35">GROUP BY column_name;</a>
<a class="sourceLine" id="cb2-36" title="36"></a>
<a class="sourceLine" id="cb2-37" title="37">SELECT <span class="kw">COUNT</span>(column_name)</a>
<a class="sourceLine" id="cb2-38" title="38">FROM   table_name</a>
<a class="sourceLine" id="cb2-39" title="39">WHERE  CONDITION;</a>
<a class="sourceLine" id="cb2-40" title="40"></a>
<a class="sourceLine" id="cb2-41" title="41">SELECT <span class="kw">SUM</span>(column_name)</a>
<a class="sourceLine" id="cb2-42" title="42">FROM   table_name</a>
<a class="sourceLine" id="cb2-43" title="43">WHERE  CONDITION</a>
<a class="sourceLine" id="cb2-44" title="44">GROUP BY column_name</a>
<a class="sourceLine" id="cb2-45" title="45"><span class="kw">HAVING</span> (arithematic <span class="cf">function</span> condition);</a></code></pre></div>
</div>
<div id="crearactualizarborrar-tablas-sql-8-statements" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Crear/Actualizar/Borrar tablas SQL (8 statements)</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">CREATE TABLE <span class="kw">table_name</span>(</a>
<a class="sourceLine" id="cb3-2" title="2">column1 datatype,</a>
<a class="sourceLine" id="cb3-3" title="3">column2 datatype,</a>
<a class="sourceLine" id="cb3-4" title="4">column3 datatype,</a>
<a class="sourceLine" id="cb3-5" title="5">.....</a>
<a class="sourceLine" id="cb3-6" title="6">columnN datatype,</a>
<a class="sourceLine" id="cb3-7" title="7">PRIMARY <span class="kw">KEY</span>( one or more columns )</a>
<a class="sourceLine" id="cb3-8" title="8">);</a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10">DROP TABLE table_name;</a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12">CREATE UNIQUE INDEX index_name</a>
<a class="sourceLine" id="cb3-13" title="13">ON <span class="kw">table_name</span> ( column1, column2,...columnN);</a>
<a class="sourceLine" id="cb3-14" title="14"></a>
<a class="sourceLine" id="cb3-15" title="15">ALTER TABLE table_name</a>
<a class="sourceLine" id="cb3-16" title="16">DROP INDEX index_name;</a>
<a class="sourceLine" id="cb3-17" title="17"></a>
<a class="sourceLine" id="cb3-18" title="18">DESC table_name;</a>
<a class="sourceLine" id="cb3-19" title="19"></a>
<a class="sourceLine" id="cb3-20" title="20">TRUNCATE TABLE table_name;</a>
<a class="sourceLine" id="cb3-21" title="21"></a>
<a class="sourceLine" id="cb3-22" title="22">ALTER TABLE table_name {ADD<span class="op">|</span>DROP<span class="op">|</span>MODIFY} column_name {data_ype};</a>
<a class="sourceLine" id="cb3-23" title="23"></a>
<a class="sourceLine" id="cb3-24" title="24">ALTER TABLE table_name RENAME TO new_table_name;</a></code></pre></div>
</div>
<div id="anadiractualizarborrar-tuplas-en-sql-3-statements" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Añadir/Actualizar/Borrar tuplas en SQL (3 statements)</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">INSERT INTO <span class="kw">table_name</span>( column1, column2....columnN)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">VALUES</span> ( value1, value2....valueN);</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4">UPDATE table_name</a>
<a class="sourceLine" id="cb4-5" title="5">SET column1 =<span class="st"> </span>value1, column2 =<span class="st"> </span>value2....columnN=valueN</a>
<a class="sourceLine" id="cb4-6" title="6">[ WHERE  CONDITION ];</a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8">DELETE FROM table_name</a>
<a class="sourceLine" id="cb4-9" title="9">WHERE  {CONDITION};</a></code></pre></div>
</div>
<div id="gestion-bases-de-datos-5-statements" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Gestión Bases de Datos (5 statements)</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">CREATE DATABASE database_name;</a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3">DROP DATABASE database_name;</a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5">USE database_name;</a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7">COMMIT;</a>
<a class="sourceLine" id="cb5-8" title="8"></a>
<a class="sourceLine" id="cb5-9" title="9">ROLLBACK;</a></code></pre></div>
</div>
<div id="ejemplos-de-consultas-sql" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Ejemplos de consultas SQL</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">SELECT Nombre, Apellido1, Apellido2, Municipio, Provincia </a>
<a class="sourceLine" id="cb6-2" title="2">FROM Cliente</a>
<a class="sourceLine" id="cb6-3" title="3">WHERE Municipio =<span class="st"> &#39;Lugo&#39;</span></a>
<a class="sourceLine" id="cb6-4" title="4">ORDER BY Apellido1</a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6">INSERT <span class="kw">Proveedor</span>(Nombre, PersonaContacto, Ciudad, País)</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="kw">VALUES</span> (<span class="st">&#39;Café Candelas&#39;</span>, <span class="st">&#39;Ivana Candelas&#39;</span>, <span class="st">&#39;Lugo&#39;</span>, <span class="st">&#39;España&#39;</span>)</a>
<a class="sourceLine" id="cb6-8" title="8"></a>
<a class="sourceLine" id="cb6-9" title="9">UPDATE Pedidos</a>
<a class="sourceLine" id="cb6-10" title="10">SET Cantidad =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb6-11" title="11">WHERE IdProducto =<span class="st"> </span><span class="dv">963</span></a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13">DELETE Cliente</a>
<a class="sourceLine" id="cb6-14" title="14">WHERE Email =<span class="st"> &#39;alexandregb@gmail.com&#39;</span></a></code></pre></div>
</div>
</div>
<div id="conexion-con-bases-de-datos-desde-r" class="section level2">
<h2><span class="header-section-number">2.3</span> Conexión con bases de datos desde R</h2>
<div id="introduccion-a-sql-en-r" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Introducción a SQL en R</h3>
<p>SQL se usa para manipular datos dentro de una base de datos. Si la base de datos no es muy grande se puede cargar toda en un data.frame.
No obstante, por escalabilidad y offloading de la carga de trabajo al servidor SGBD utilizaremos SQL.</p>
<p>Existen varios SGBD (SQLite, Microsoft SQL Server, PostgreSQL, etc) los cuales comparten el soporte de SQL (en concreto ANSI SQL) aunque cada gestor extiende SQL
de formas sutiles buscando minar cierta portabilidad de código (<em>vendor-locking</em>). En efecto, un código SQL desarrollado para SQLite es probable que falle con MySQL
aunque tras aplicar ligeras modificaciones ya funcionará. Asimismo el mecanismo de conexión, configuración, rendimiento y operación suele diferir entre SGBD.</p>
<p>A continuación se lista una serie de paquetes utilizados en el acceso a los datos, lo que suele ser el principal esfuerzo a realizar cuando se trabaja con SGBD:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/DBI/index.html">DBI</a></li>
<li><a href="https://cran.r-project.org/web/packages/RODBC/index.html">RODBC</a></li>
<li><a href="https://cran.r-project.org/web/packages/dbConnect/index.html">dbConnect</a></li>
<li><a href="https://cran.r-project.org/web/packages/RSQLite/index.html">RSQLite</a></li>
<li><a href="https://cran.r-project.org/web/packages/RMySQL/index.html">RMySQL</a></li>
<li><a href="https://cran.r-project.org/web/packages/RPostgreSQL/index.html">RPostgreSQL</a></li>
</ul>
</div>
<div id="el-paquete-sqldf" class="section level3">
<h3><span class="header-section-number">2.3.2</span> El paquete sqldf</h3>
<p>A continuación se presenta una serie de ejercicios con la sintaxis de SQL operando sobre un data.frame con el paquete sqldf. Esto inicialmente no incluye los detalles de conectarse a un SGBD, ni modificar los
datos, solamente el uso de SQL para extraer datos con el objetivo de ser analizados en R.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">library</span>(sqldf)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">sqldf</span>(<span class="st">&#39;SELECT age, circumference FROM Orange WHERE Tree = 1 ORDER BY circumference ASC&#39;</span>)</a></code></pre></div>
<pre><code>##    age circumference
## 1  118            30
## 2  484            58
## 3  664            87
## 4 1004           115
## 5 1231           120
## 6 1372           142
## 7 1582           145</code></pre>
</div>
<div id="sql-queries" class="section level3">
<h3><span class="header-section-number">2.3.3</span> SQL Queries</h3>
<p>El comando inicial es SELECT. SQL no es case-sensitive, por lo que esto va a funcionar:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">sqldf</span>(<span class="st">&quot;SELECT * FROM iris&quot;</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">sqldf</span>(<span class="st">&quot;select * from iris&quot;</span>)</a></code></pre></div>
<p>pero lo siguiente no va a funcionar (a menos que tengamos un objeto IRIS:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">sqldf</span>(<span class="st">&quot;SELECT * FROM IRIS&quot;</span>)</a></code></pre></div>
<p>La sintaxis básica de SELECT es:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">SELECT variable1, variable2 FROM data</a></code></pre></div>
<div id="asteriscowildcard" class="section level4">
<h4><span class="header-section-number">2.3.3.1</span> Asterisco/Wildcard</h4>
<p>Lo extrae todo</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">bod2 &lt;-<span class="st"> </span><span class="kw">sqldf</span>(<span class="st">&#39;SELECT * FROM BOD&#39;</span>)</a></code></pre></div>
</div>
<div id="limit" class="section level4">
<h4><span class="header-section-number">2.3.3.2</span> Limit</h4>
<p>Limita el número de resultados</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">sqldf</span>(<span class="st">&#39;SELECT * FROM iris LIMIT 5&#39;</span>)</a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa</code></pre>
</div>
<div id="order-by" class="section level4">
<h4><span class="header-section-number">2.3.3.3</span> Order By</h4>
<p>Ordena las variables</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">ORDER BY var1 {ASC<span class="op">/</span>DESC}, var2 {ASC<span class="op">/</span>DESC}</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">sqldf</span>(<span class="st">&quot;SELECT * FROM Orange ORDER BY age ASC, circumference DESC LIMIT 5&quot;</span>)</a></code></pre></div>
<pre><code>##   Tree age circumference
## 1    2 118            33
## 2    4 118            32
## 3    1 118            30
## 4    3 118            30
## 5    5 118            30</code></pre>
</div>
<div id="where" class="section level4">
<h4><span class="header-section-number">2.3.3.4</span> Where</h4>
<p>Sentencias condicionales, donde se puede incorporar operadores lógicos AND y OR, expresando el orden de evaluación con paréntesis en caso de ser necesario.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">sqldf</span>(<span class="st">&#39;SELECT demand FROM BOD WHERE Time &lt; 3&#39;</span>)</a></code></pre></div>
<pre><code>##   demand
## 1    8.3
## 2   10.3</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">sqldf</span>(<span class="st">&#39;SELECT * FROM rock WHERE (peri &gt; 5000 AND shape &lt; .05) OR perm &gt; 1000&#39;</span>)</a></code></pre></div>
<pre><code>##   area     peri    shape perm
## 1 5048  941.543 0.328641 1300
## 2 1016  308.642 0.230081 1300
## 3 5605 1145.690 0.464125 1300
## 4 8793 2280.490 0.420477 1300</code></pre>
<p>Y extendiendo su uso con IN o LIKE (es último sólo con %), pudiendo aplicárseles el NOT:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">sqldf</span>(<span class="st">&#39;SELECT * FROM BOD WHERE Time IN (1,7)&#39;</span>)</a></code></pre></div>
<pre><code>##   Time demand
## 1    1    8.3
## 2    7   19.8</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">sqldf</span>(<span class="st">&#39;SELECT * FROM BOD WHERE Time NOT IN (1,7)&#39;</span>)</a></code></pre></div>
<pre><code>##   Time demand
## 1    2   10.3
## 2    3   19.0
## 3    4   16.0
## 4    5   15.6</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">sqldf</span>(<span class="st">&#39;SELECT * FROM chickwts WHERE feed LIKE &quot;%bean&quot; LIMIT 5&#39;</span>)</a></code></pre></div>
<pre><code>##   weight      feed
## 1    179 horsebean
## 2    160 horsebean
## 3    136 horsebean
## 4    227 horsebean
## 5    217 horsebean</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">sqldf</span>(<span class="st">&#39;SELECT * FROM chickwts WHERE feed NOT LIKE &quot;%bean&quot; LIMIT 5&#39;</span>)</a></code></pre></div>
<pre><code>##   weight    feed
## 1    309 linseed
## 2    229 linseed
## 3    181 linseed
## 4    141 linseed
## 5    260 linseed</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduccion-a-las-tecnologias-de-gestion-de-datos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduccion-a-tecnologias-nosql.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/gltaboada/tgdbook/edit/master/02-SQL.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Practicas_de_TGD.pdf", "Practicas_de_TGD.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
